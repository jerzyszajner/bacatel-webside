const THEME_STORAGE_KEY="bacatel-theme",THEME_LIGHT="light",THEME_DARK="dark";function getSystemPrefersDark(){return window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches}function getEffectiveTheme(){const e=document.documentElement.getAttribute("data-theme");return"light"===e||"dark"===e?e:getSystemPrefersDark()?"dark":"light"}function updateThemeUI(e){document.documentElement.style.colorScheme="dark"===e?"dark":"light";const t=document.getElementById("theme-color");t&&t.setAttribute("content","dark"===e?"#121110":"#f2ede6");const o=document.querySelector(".theme-toggle");o&&(o.setAttribute("aria-label","dark"===e?"Przełącz tryb jasny":"Przełącz tryb ciemny"),o.setAttribute("title","dark"===e?"Tryb jasny":"Tryb ciemny"))}function initTheme(){const e=localStorage.getItem("bacatel-theme");"light"!==e&&"dark"!==e||document.documentElement.setAttribute("data-theme",e),updateThemeUI(getEffectiveTheme());const t=document.querySelector(".theme-toggle");t&&t.addEventListener("click",toggleTheme)}function toggleTheme(){const e="dark"===getEffectiveTheme()?"light":"dark";document.documentElement.setAttribute("data-theme",e),localStorage.setItem("bacatel-theme",e),updateThemeUI(e)}function initNav(){const e=document.querySelector(".nav-toggle"),t=document.querySelector(".nav");function o(){const t="true"===e.getAttribute("aria-expanded");e.setAttribute("aria-label",t?"Zamknij menu":"Otwórz menu")}e&&t&&(e.addEventListener("click",()=>{const n="true"===e.getAttribute("aria-expanded");e.setAttribute("aria-expanded",!n),t.classList.toggle("is-open"),o()}),t.querySelectorAll(".nav__link").forEach(n=>{n.addEventListener("click",()=>{e.setAttribute("aria-expanded","false"),t.classList.remove("is-open"),o(),e.focus()})}))}function initGallery(){const e=document.querySelector(".gallery.swiper");e&&new Swiper(e,{loop:!0,autoplay:{delay:5e3,disableOnInteraction:!1,pauseOnMouseEnter:!0},keyboard:{enabled:!0,onlyInViewport:!0},navigation:{nextEl:".gallery__btn--next",prevEl:".gallery__btn--prev"},pagination:{el:".swiper-pagination",clickable:!0}})}function updateHoursStatus(){const e=document.getElementById("hours-status");if(!e)return;const t=new Date,o=t.toLocaleDateString("en-CA",{timeZone:"Europe/Warsaw"}),n=t.toLocaleTimeString("en-GB",{timeZone:"Europe/Warsaw",hour12:!1}),[a,r,i]=o.split("-").map(Number),[s,c]=n.split(":").map(Number),l=new Date(a,r-1,i).getDay(),d=60*s+c;if(e.classList.remove("hero__hours-status--open","hero__hours-status--closed"),0===l)return e.textContent="Zamknięte – otwarcie w poniedziałek 9:00",void e.classList.add("hero__hours-status--closed");const[u,m]={1:[540,1020],2:[540,1020],3:[540,1020],4:[540,1020],5:[540,1020],6:[540,780]}[l]||[0,0];if(d<u)e.textContent="Zamknięte – otwarcie dziś 9:00",e.classList.add("hero__hours-status--closed");else if(d>=m)e.textContent=6===l?"Zamknięte – otwarcie w poniedziałek 9:00":"Zamknięte – otwarcie jutro 9:00",e.classList.add("hero__hours-status--closed");else{const t=Math.floor(m/60);e.textContent="Otwarte do "+t+":00",e.classList.add("hero__hours-status--open")}}function updateActiveNav(){const e=document.querySelectorAll(".nav__link"),t=document.querySelectorAll("#o-nas, #galeria, #oferta, #serwis, #kontakt"),o=window.scrollY+120;let n=null;for(const e of t){const t=e.offsetTop,a=e.offsetHeight;if(o>=t&&o<t+a){n=e.id;break}}e.forEach(e=>{e.getAttribute("href")===`#${n}`?e.classList.add("nav__link--active"):e.classList.remove("nav__link--active")})}function clearActiveNav(){document.querySelectorAll(".nav__link").forEach(e=>{e.classList.remove("nav__link--active")})}function initActiveNav(){updateActiveNav(),window.addEventListener("scroll",updateActiveNav,{passive:!0})}function scrollToTop(e){e&&e.preventDefault(),window.scrollTo({top:0,behavior:"smooth"})}document.addEventListener("DOMContentLoaded",()=>{initTheme(),updateHoursStatus(),initNav(),initGallery(),initActiveNav();const e=document.querySelector('.logo[href="#top"]');e&&e.addEventListener("click",t=>{t.preventDefault(),scrollToTop(),history.replaceState(null,"",window.location.pathname+window.location.search),clearActiveNav(),e.blur()});const t=document.querySelector(".scroll-top");if(t){t.addEventListener("click",e=>{e.preventDefault(),scrollToTop()});const e=()=>{window.scrollY>400?t.classList.add("is-visible"):t.classList.remove("is-visible")};e(),window.addEventListener("scroll",e,{passive:!0})}const o=document.querySelector(".contact-map__iframe[data-src]");if(o&&"IntersectionObserver"in window){const e=new IntersectionObserver(t=>{if(t[0].isIntersecting){const t=o.getAttribute("data-src");t&&(o.setAttribute("src",t),o.removeAttribute("data-src")),e.disconnect()}},{rootMargin:"100px"});e.observe(o)}else if(o){const e=o.getAttribute("data-src");e&&(o.setAttribute("src",e),o.removeAttribute("data-src"))}});