const THEME_STORAGE_KEY="bacatel-theme",THEME_LIGHT="light",THEME_DARK="dark";function getCurrentTheme(){return"dark"===document.documentElement.getAttribute("data-theme")?"dark":"light"}function updateThemeUI(e){document.documentElement.style.colorScheme="dark"===e?"dark":"light";const t=document.getElementById("theme-color");t&&t.setAttribute("content","dark"===e?"#121110":"#f2ede6");const n=document.querySelector(".theme-toggle");n&&(n.setAttribute("aria-label","dark"===e?"Przełącz tryb jasny":"Przełącz tryb ciemny"),n.setAttribute("title","dark"===e?"Tryb jasny":"Tryb ciemny"))}function initTheme(){updateThemeUI(getCurrentTheme());const e=document.querySelector(".theme-toggle");e&&e.addEventListener("click",toggleTheme)}function toggleTheme(){const e="dark"===getCurrentTheme()?"light":"dark";document.documentElement.setAttribute("data-theme",e),localStorage.setItem("bacatel-theme",e),updateThemeUI(e)}function initNav(){const e=document.querySelector(".nav-toggle"),t=document.querySelector(".nav");function n(){const t="true"===e.getAttribute("aria-expanded");e.setAttribute("aria-label",t?"Zamknij menu":"Otwórz menu")}e&&t&&(e.addEventListener("click",()=>{const o="true"===e.getAttribute("aria-expanded");e.setAttribute("aria-expanded",!o),t.classList.toggle("is-open"),n()}),t.querySelectorAll(".nav__link").forEach(o=>{o.addEventListener("click",()=>{e.setAttribute("aria-expanded","false"),t.classList.remove("is-open"),n(),e.focus()})}))}function initGallery(){const e=document.querySelector(".gallery.swiper");e&&new Swiper(e,{loop:!0,autoplay:{delay:5e3,disableOnInteraction:!1,pauseOnMouseEnter:!0},keyboard:{enabled:!0,onlyInViewport:!0},navigation:{nextEl:".gallery__btn--next",prevEl:".gallery__btn--prev"},pagination:{el:".swiper-pagination",clickable:!0}})}function updateHoursStatus(){const e=document.getElementById("hours-status");if(!e)return;const t=new Date,n={timeZone:"Europe/Warsaw"},o=Object.fromEntries(new Intl.DateTimeFormat("en-CA",n).formatToParts(t).map(e=>[e.type,e.value])),r=Object.fromEntries(new Intl.DateTimeFormat("en-GB",{...n,hour12:!1}).formatToParts(t).map(e=>[e.type,e.value])),a=new Date(Number(o.year),Number(o.month)-1,Number(o.day)).getDay(),i=60*Number(r.hour)+Number(r.minute||0);if(e.classList.remove("hero__hours-status--open","hero__hours-status--closed"),0===a)return e.textContent="Zamknięte – otwarcie w poniedziałek 9:00",void e.classList.add("hero__hours-status--closed");const[s,c]={1:[540,1020],2:[540,1020],3:[540,1020],4:[540,1020],5:[540,1020],6:[540,780]}[a]||[0,0];if(i<s)e.textContent="Zamknięte – otwarcie dziś 9:00",e.classList.add("hero__hours-status--closed");else if(i>=c)e.textContent=6===a?"Zamknięte – otwarcie w poniedziałek 9:00":"Zamknięte – otwarcie jutro 9:00",e.classList.add("hero__hours-status--closed");else{const t=Math.floor(c/60);e.textContent="Otwarte do "+t+":00",e.classList.add("hero__hours-status--open")}}const SCROLL_TOP_THRESHOLD=Math.min(400,"undefined"!=typeof window?window.innerHeight:400);function setActiveNav(e){document.querySelectorAll(".nav__link").forEach(t=>{t.classList.toggle("nav__link--active",t.getAttribute("href")===`#${e}`)})}function clearActiveNav(){document.querySelectorAll(".nav__link").forEach(e=>e.classList.remove("nav__link--active"))}function handleScrollToTop(e){window.scrollTo({top:0,behavior:"smooth"}),history.replaceState(null,"",location.pathname+location.search),clearActiveNav(),e&&e.blur()}function initScroll(){const e=document.querySelector(".header"),t=e?.offsetHeight??72,n=document.querySelector(".logo"),o=document.querySelector(".scroll-top"),r=document.querySelectorAll("#o-nas, #galeria, #oferta, #serwis, #kontakt"),a=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&setActiveNav(e.target.id)})},{root:null,rootMargin:`-${t}px 0px -60% 0px`,threshold:0});r.forEach(e=>a.observe(e));let i=!1;function s(){if(o){const e=window.scrollY>SCROLL_TOP_THRESHOLD;o.classList.toggle("is-visible",e),o.setAttribute("aria-hidden",e?"false":"true")}i=!1}window.addEventListener("scroll",()=>{i||(window.requestAnimationFrame(s),i=!0)},{passive:!0}),s(),n&&n.addEventListener("click",e=>{e.preventDefault(),handleScrollToTop(n)}),o&&o.addEventListener("click",e=>{e.preventDefault(),handleScrollToTop(o)})}function initMap(){const e=document.querySelector(".contact-map__iframe[data-src]");if(e)if("IntersectionObserver"in window){const t=new IntersectionObserver(n=>{if(n[0].isIntersecting){const n=e.getAttribute("data-src");n&&(e.setAttribute("src",n),e.removeAttribute("data-src")),t.disconnect()}},{rootMargin:"100px"});t.observe(e)}else{const t=e.getAttribute("data-src");t&&(e.setAttribute("src",t),e.removeAttribute("data-src"))}}document.addEventListener("DOMContentLoaded",()=>{initTheme(),updateHoursStatus(),initNav(),initGallery(),initScroll(),initMap()});